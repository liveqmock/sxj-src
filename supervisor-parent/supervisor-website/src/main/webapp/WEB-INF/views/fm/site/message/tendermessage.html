<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>私享家绿色门窗平台</title>
<meta name="keywords" content="私享家绿色门窗平台,门窗,型材厂,玻璃厂,门窗">
<meta name="description" content="私享家绿色门窗平台,为门窗行业的玻璃厂,型材厂提供产品盘点,物流跟踪,质量溯源服务。致力于推动江苏省房地产建筑行业绿色环保事业。">
<link href="${b.staticPath}style/style.css" rel="stylesheet" type="text/css" />
<script src="${b.staticPath}js/jquery.js" type="text/javascript"></script> 
<script src="${b.staticPath}js/jquery.paginate.js"></script>
<script src="${b.staticPath}js/tytabs.jquery.min.js" type="text/javascript"></script>
<!--  -->
<script type="text/javascript" src="${b.staticPath}js/highcharts.js"></script>
<script type="text/javascript">
$(function(){
	$("#configType").change(function() {
		 var ischecked=$(this).attr("checked");
		 var accept=false;
		 var id=$("#configId").val();
		 if(ischecked=="checked"){
			 accept=true;
		 }
		 $.post("changeConfig.htm",{configId:id,isAccept:accept} ,function(data){
			 if(data.isOK=="ok"){
				 $("#configId").val(data.configId);
			 }
		 });
	});
	
});

function query(page) {
	var params = "";
	if (page != undefined) {
		params = params + "?currentPage=" + page;
	}
	$.post("query.htm", params, function(data) {
		var res = $(data).find(".invList");
		var pager = $(data).find("#pager");
		$(".invList").empty();
		$(".invList").append(res.html());
		var totalPage = pager.attr("totalPage");
		var currentPage = pager.attr("currentPage");
		loadPage(currentPage, totalPage, query);
	});
}

function modifyState(id,infoId){
	var state=$("#message_li_"+infoId).attr("state");
	if(state==0){
		$.post("modifyState.htm","id="+id,function(data){
			if(data.isOK="ok"){
				$("#message_li_"+infoId).attr("state",1);
				$("#message_li_"+infoId).removeClass("bgUnread");
				$("#message_li_"+infoId).addClass("bgGray");
				window.location.href="${basePath}market/info.htm?id="+infoId;
				$.get("${basePath}market/info.htm?id="+infoId",function(data){
					var res = $(data).find(".rightSide");
					$(".rightSide").empty();
					$(".rightSide").append(res.html());
				});
			}
		});
	}else{
		$.get("${basePath}market/info.htm?id="+infoId",function(data){
				var res = $(data).find(".rightSide");
				$(".rightSide").empty();
				$(".rightSide").append(res.html());
		});
	}
 }
}} 
$(document).ready(function(){
	$("#tabsholder").tytabs({
							prefixtabs:"tabz",
							prefixcontent:"content",
							classcontent:"tabscontent",
							tabinit:"3",
							catchget:"tab2",
							fadespeed:"normal"
							});
   $.post("${basePath}al/info.htm",function(data){
	   var dateList=new Array();
	   var maxList=new Array();
	   var minList=new Array();
	   var averageList=new Array();
	   for (var i=data.list.length-1;i>=0;i--){
		   dateList[i]=data.list[i].date;
		   maxList[i]=data.list[i].max;
		   minList[i]=data.list[i].min;
		   averageList[i]=data.list[i].average;
	   }
	   $("#lvchart").highcharts({
		   title: { text: '近30天铝价格走势图', x: -20 //center 
			   },
			   xAxis: { categories: dateList},
			   yAxis: { title: { text: 'Temperature (°C)' }, plotLines: [{ value: 0, width: 1, color: '#808080' }] },
			   legend: { layout: 'vertical', align: 'right', verticalAlign: 'middle', borderWidth: 0 },
			   series: [{ name: 'max', data: maxList },
			           { name: 'min', data: minList }, 
			           { name: 'average', data: averageList }]
		   
		   
		   
	   });
   })
});
</script>
</head>
<body>
<@b.header />
<div class="fence-wide ly-clearFix">
<div class="yard-190 mt15 ly-left">
<@b.leftMenu />
</div>
<div class="yard-870 rightSide ly-left inviteBox">
<div class="heading mb15 ly-clearFix">
<h1>
  <span class="title fontYH f20 fb">市场信息</span></h1>
</div>
<div class="bgOk fb">
<#if messageConfig??>
	<#if messageConfig.messageType.getId()==5>
		<#if messageConfig.isAccetp==true>
			<input id="configType" name="input" type="checkbox"  value="5" checked="checked"/>
			<input id="configId" type="hidden" name="configId" value="${messageConfig.id}"/>
		<#else>
			<input id="configType" name="input" type="checkbox"  value="5"/>
			<input type="hidden" name="configId" value="${messageConfig.id}"/>
		</#if>
	<#else>
		<input id="configType" name="input" type="checkbox"  value="5"/>
		<input id="configId" type="hidden" name="configId" value=""/>
	</#if>
<#else>
	<input id="configType" name="input" type="checkbox"  value="5"/>
	<input id="configId" type="hidden" name="configId" value=""/>
</#if>
  <span class="ml5">接收市场信息短信</span>
</div>
<div class="contBox">
<div id="tabsholder">
<ul class="tabs">
 <li id="tabz1"><a href="#">江苏省开发商招标信息</a></li> 
 <li id="tabz2"><a href="#">当日铝锭参考价</a></li>
</ul>
<div class="contents"> 
<div id="content1" class="tabscontent"> 
<ul class="invList" onclick="modifyState('${message.id}','${message.infoId}');">
<#list messageList as message>
	<#if message.state.getId()==0>
		<li class="bgUnread" id="message_li_${message.infoId}" state="${message.state.getId()}">
			<span class="icon icon-invi-unread"></span>
			<span class="time mr10"><#if (message.nowDate??)> ${message.nowDate?date}</#if></span>
			<a href="invite-info.html">${message.xmmc}</a>
		</li>
	<#else>
		<li class="bgGray" id="message_li_${message.infoId}" state="${message.state.getId()}">
			<span class="icon icon-invi-read"></span>
			<span class="time mr10"><#if (message.nowDate??)> ${message.nowDate?date}</#if></span>
			<a href="invite-info.html">${message.xmmc}</a>
		</li>
	</#if>
</#list>
</ul>
</div>
<div id="content2" class="tabscontent">
     <div class="con"  id="lvchart"></div>
  </div>
<div class="ly-clearFix">
<@b.pager/>
</div>
</div>
  </div>
</div>
</div>
<!--</div>
 </div> -->
<@b.footer />
</body>
</html>
